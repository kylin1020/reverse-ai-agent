/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
import{paginate as e}from"../utils/pagination.js";function t(e,n=0){const o=[];o.push({node:e,depth:n});for(const s of e.children)o.push(...t(s,n+1));return o}function n(e,t,n){const s=o(e);return" ".repeat(2*t)+s.join(" ")+(e.id===n?.selectedElementUid?" [selected in the DevTools Elements panel]":"")}export function formatSnapshotNode(e,t,n=0){const s=[];0===n&&t?.verbose&&t?.hasSelectedElement&&!t.selectedElementUid&&s.push("Note: there is a selected element in the DevTools Elements panel but it is not included into the current a11y tree snapshot.\nGet a verbose snapshot to include all elements if you are interested in the selected element.\n\n");const l=o(e),a=" ".repeat(2*n)+l.join(" ")+(e.id===t?.selectedElementUid?" [selected in the DevTools Elements panel]":"")+"\n";s.push(a);for(const o of e.children)s.push(formatSnapshotNode(o,t,n+1));return s.join("")}export function formatSnapshotWithOptions(s,l,a){const i=[];l?.verbose&&l?.hasSelectedElement&&!l.selectedElementUid&&i.push("Note: there is a selected element in the DevTools Elements panel but it is not included into the current a11y tree snapshot.\nGet a verbose snapshot to include all elements if you are interested in the selected element.");const r=t(s),c=r.length;let d=r;a?.search&&(d=r.filter(({node:e})=>function(e,t){const n=t.toLowerCase();return o(e).join(" ").toLowerCase().includes(n)}(e,a.search)));const h=d.length,u=e(d,a?.pagination);for(const{node:e,depth:t}of u.items)i.push(n(e,t,l));return{content:i.join("\n"),totalElements:c,matchedElements:h,currentPage:u.currentPage,totalPages:u.totalPages,hasNextPage:u.hasNextPage,hasPreviousPage:u.hasPreviousPage}}function o(e){const t=[`uid=${e.id}`];e.role&&t.push("none"===e.role?"ignored":e.role),e.name&&t.push(`"${e.name}"`);const n=new Set(["id","role","name","elementHandle","children","backendNodeId"]),o={disabled:"disableable",expanded:"expandable",focused:"focusable",selected:"selectable"};for(const s of Object.keys(e).sort()){if(n.has(s))continue;const l=e[s];"boolean"==typeof l?(o[s]&&t.push(o[s]),l&&t.push(s)):"string"!=typeof l&&"number"!=typeof l||t.push(`${s}="${l}"`)}return t}