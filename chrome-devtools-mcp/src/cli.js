/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
import{yargs as e,hideBin as t}from"./third_party/index.js";export const cliOptions={autoConnect:{type:"boolean",description:"If specified, automatically connects to a browser (Chrome 145+) running in the user data directory identified by the channel param. Requires remote debugging being enabled in Chrome here: chrome://inspect/#remote-debugging.",conflicts:["isolated","executablePath"],default:!1,coerce:e=>{if(e)return e}},cdpUrl:{type:"string",description:"Default CDP URL to connect to a running Chrome instance. Set to empty string to disable CDP-first connection mode.",alias:"c",default:"http://127.0.0.1:9222",coerce:e=>{if(e&&""!==e){try{new URL(e)}catch{throw new Error(`Provided cdpUrl ${e} is not valid URL.`)}return e}}},nativeLaunch:{type:"boolean",description:"Launch Chrome natively and connect via CDP instead of using Puppeteer launch. This reduces detection risk. Default is true.",default:!0},browserUrl:{type:"string",description:"Connect to a running, debuggable Chrome instance (e.g. `http://127.0.0.1:9222`). For more details see: https://github.com/ChromeDevTools/chrome-devtools-mcp#connecting-to-a-running-chrome-instance.",alias:"u",conflicts:"wsEndpoint",coerce:e=>{if(e){try{new URL(e)}catch{throw new Error(`Provided browserUrl ${e} is not valid URL.`)}return e}}},wsEndpoint:{type:"string",description:"WebSocket endpoint to connect to a running Chrome instance (e.g., ws://127.0.0.1:9222/devtools/browser/<id>). Alternative to --browserUrl.",alias:"w",conflicts:"browserUrl",coerce:e=>{if(e)try{const t=new URL(e);if("ws:"!==t.protocol&&"wss:"!==t.protocol)throw new Error(`Provided wsEndpoint ${e} must use ws:// or wss:// protocol.`);return e}catch(t){if(t.message.includes("ws://"))throw t;throw new Error(`Provided wsEndpoint ${e} is not valid URL.`)}}},wsHeaders:{type:"string",description:'Custom headers for WebSocket connection in JSON format (e.g., \'{"Authorization":"Bearer token"}\'). Only works with --wsEndpoint.',implies:"wsEndpoint",coerce:e=>{if(e)try{const t=JSON.parse(e);if("object"!=typeof t||Array.isArray(t))throw new Error("Headers must be a JSON object");return t}catch(e){throw new Error(`Invalid JSON for wsHeaders: ${e.message}`)}}},headless:{type:"boolean",description:"Whether to run in headless (no UI) mode.",default:!1},noSandbox:{type:"boolean",description:"Disable Chrome sandboxes. Required for running in Docker/server environments. Automatically enabled in headless mode on Linux.",default:!1},executablePath:{type:"string",description:"Path to custom Chrome executable.",conflicts:["browserUrl","wsEndpoint"],alias:"e"},isolated:{type:"boolean",description:"If specified, creates a temporary user-data-dir that is automatically cleaned up after the browser is closed. Defaults to false."},userDataDir:{type:"string",description:"Path to the user data directory for Chrome. Default is $HOME/.cache/chrome-devtools-mcp/chrome-profile$CHANNEL_SUFFIX_IF_NON_STABLE",conflicts:["browserUrl","wsEndpoint","isolated"]},channel:{type:"string",description:"Specify a different Chrome channel that should be used. The default is the stable channel version.",choices:["stable","canary","beta","dev"],conflicts:["browserUrl","wsEndpoint","executablePath"]},logFile:{type:"string",describe:"Path to a file to write debug logs to. Set the env variable `DEBUG` to `*` to enable verbose logs. Useful for submitting bug reports."},viewport:{type:"string",describe:"Initial viewport size for the Chrome instances started by the server. For example, `1280x720`. In headless mode, max size is 3840x2160px.",coerce:e=>{if(void 0===e)return;const[t,o]=e.split("x").map(Number);if(!t||!o||Number.isNaN(t)||Number.isNaN(o))throw new Error("Invalid viewport. Expected format is `1280x720`.");return{width:t,height:o}}},proxyServer:{type:"string",description:"Proxy server configuration for Chrome passed as --proxy-server when launching the browser. See https://www.chromium.org/developers/design-documents/network-settings/ for details. Example: http://proxy.example.com:8080 or socks5://proxy.example.com:1080"},proxyUsername:{type:"string",description:"Username for proxy authentication. Only works when --proxyServer is set.",implies:"proxyServer"},proxyPassword:{type:"string",description:"Password for proxy authentication. Only works when --proxyServer is set.",implies:"proxyServer"},acceptInsecureCerts:{type:"boolean",description:"If enabled, ignores errors relative to self-signed and expired certificates. Use with caution."},experimentalDevtools:{type:"boolean",describe:"Whether to enable automation over DevTools targets",hidden:!0},experimentalIncludeAllPages:{type:"boolean",describe:"Whether to include all kinds of pages such as webviews or background pages as pages.",hidden:!0},chromeArg:{type:"array",describe:"Additional arguments for Chrome. Only applies when Chrome is launched by chrome-devtools-mcp."},categoryEmulation:{type:"boolean",default:!0,describe:"Set to false to exclude tools related to emulation."},categoryNetwork:{type:"boolean",default:!0,describe:"Set to false to exclude tools related to network."}};export function parseArguments(o,r=process.argv){const n=e(t(r)).scriptName("npx chrome-devtools-mcp@latest").options(cliOptions).check(e=>(e.channel||e.browserUrl||e.wsEndpoint||e.executablePath||(e.channel="stable"),!0)).example([["$0 --browserUrl http://127.0.0.1:9222","Connect to an existing browser instance via HTTP"],["$0 --wsEndpoint ws://127.0.0.1:9222/devtools/browser/abc123","Connect to an existing browser instance via WebSocket"],['$0 --wsEndpoint ws://127.0.0.1:9222/devtools/browser/abc123 --wsHeaders \'{"Authorization":"Bearer token"}\'',"Connect via WebSocket with custom headers"],["$0 --channel beta","Use Chrome Beta installed on this system"],["$0 --channel canary","Use Chrome Canary installed on this system"],["$0 --channel dev","Use Chrome Dev installed on this system"],["$0 --channel stable","Use stable Chrome installed on this system"],["$0 --logFile /tmp/log.txt","Save logs to a file"],["$0 --help","Print CLI options"],["$0 --viewport 1280x720","Launch Chrome with the initial viewport size of 1280x720px"],["$0 --headless","Run Chrome in headless mode (required for Linux servers/Docker)"],["$0 --no-sandbox","Disable Chrome sandboxes (required for Docker environments)"],["$0 --chrome-arg='--no-sandbox' --chrome-arg='--disable-setuid-sandbox'","Launch Chrome without sandboxes using explicit args. Use with caution."],["$0 --no-category-emulation","Disable tools in the emulation category"],["$0 --no-category-network","Disable tools in the network category"],["$0 --user-data-dir=/tmp/user-data-dir","Use a custom user data directory"],["$0 --auto-connect","Connect to a stable Chrome instance (Chrome 145+) running instead of launching a new instance"],["$0 --auto-connect --channel=canary","Connect to a canary Chrome instance (Chrome 145+) running instead of launching a new instance"],["$0 --proxy-server=http://proxy.example.com:8080","Use an HTTP proxy server"],["$0 --proxy-server=http://proxy.example.com:8080 --proxy-username=user --proxy-password=pass","Use an HTTP proxy server with authentication"]]);return n.wrap(Math.min(120,n.terminalWidth())).help().version(o).parseSync()}